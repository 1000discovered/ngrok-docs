"use strict";(self.webpackChunkngrok_doc=self.webpackChunkngrok_doc||[]).push([[64744],{9103:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(51163),o=(a(59496),a(49613));const i={description:"Use Okta OIDC to secure access to ngrok tunnels"},r="Okta SSO (OpenID Connect)",l={unversionedId:"integrations/okta/sso-oidc",id:"integrations/okta/sso-oidc",title:"Okta SSO (OpenID Connect)",description:"Use Okta OIDC to secure access to ngrok tunnels",source:"@site/docs/integrations/okta/sso-oidc.md",sourceDirName:"integrations/okta",slug:"/integrations/okta/sso-oidc",permalink:"/docs/integrations/okta/sso-oidc",draft:!1,editUrl:"https://github.com/ngrok/ngrok-docs/edit/main/docs/integrations/okta/sso-oidc.md",tags:[],version:"current",lastUpdatedBy:"Russ Savage",lastUpdatedAt:1693002758,formattedLastUpdatedAt:"Aug 25, 2023",frontMatter:{description:"Use Okta OIDC to secure access to ngrok tunnels"},sidebar:"docs",previous:{title:"Okta SCIM User Provisioning",permalink:"/docs/integrations/okta/scim"},next:{title:"Okta SSO (SAML)",permalink:"/docs/integrations/okta/sso-saml"}},s={},p=[{value:"Supported Features",id:"supported-features",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Configuration Steps",id:"configuration-steps",level:2},{value:"<strong>Step 1</strong>: Configure Okta",id:"configure-okta",level:2},{value:"Add the ngrok App in Okta",id:"add-the-ngrok-app-in-okta",level:3},{value:"Grant access to Okta people and groups",id:"grant-access-to-okta-people-and-groups",level:3},{value:"<strong>Step 2</strong>: Configure ngrok",id:"configure-ngrok",level:2},{value:"<strong>Option 1</strong>: ngrok CLI",id:"option-1-ngrok-cli",level:3},{value:"<strong>Option 2</strong>: ngrok Edge",id:"option-2-ngrok-edge",level:3},{value:"Step 3: Test the integration",id:"test-sso",level:2}],k={toc:p},g="wrapper";function c(t){let{components:e,...i}=t;return(0,o.kt)(g,(0,n.Z)({},k,i,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"okta-sso-openid-connect"},"Okta SSO (OpenID Connect)"),(0,o.kt)("hr",null),(0,o.kt)("admonition",{title:"TL;DR",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"To secure access to ngrok with Okta Single Sign-On using OpenID Connect:"),(0,o.kt)("ol",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"#configure-okta"},"Configure Okta SSO")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"#configure-ngrok"},"Configure ngrok")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"#test-sso"},"Test access to ngrok with Okta SSO")))),(0,o.kt)("p",null,"This article details how to configure Okta as the primary Identity Provider for ngrok tunnels.\nBy integrating Okta SSO with ngrok, you can:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Restrict access to ngrok tunnels")," only to users authenticated via Okta"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Use Okta security policies, MFA authenticators")," \u2014 including Okta Verify, FastPass, and FIDO2 \u2014 ",(0,o.kt)("strong",{parentName:"li"},"and ThreatInsights to control access to ngrok tunnels"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Use Okta's Dashboard to facilitate access to ngrok apps"),".")),(0,o.kt)("h2",{id:"supported-features"},"Supported Features"),(0,o.kt)("p",null,"The ngrok integration with Okta supports:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"SP-Initiated SSO"),": In this mode, users access ngrok edges and tunnels and are redirected to Okta for authentication.")),(0,o.kt)("h2",{id:"requirements"},"Requirements"),(0,o.kt)("p",null,"To configure ngrok tunnels with Okta, you must have:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"an Okta account with administrative rights to create apps"),(0,o.kt)("li",{parentName:"ul"},"an ",(0,o.kt)("a",{parentName:"li",href:"https://ngrok.com/pricing"},"ngrok Enterprise Account")," with an authtoken or admin access to configure edges with OpenID Connect.")),(0,o.kt)("h2",{id:"configuration-steps"},"Configuration Steps"),(0,o.kt)("p",null,"To integrate ngrok with Okta SSO, you will need to:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Configure Okta with the ngrok app"),(0,o.kt)("li",{parentName:"ol"},"Configure ngrok with the SSO settings provided by Okta")),(0,o.kt)("h2",{id:"configure-okta"},(0,o.kt)("strong",{parentName:"h2"},"Step 1"),": Configure Okta"),(0,o.kt)("h3",{id:"add-the-ngrok-app-in-okta"},"Add the ngrok App in Okta"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Access your Okta Dashboard as an administrator and then click ",(0,o.kt)("strong",{parentName:"li"},"Admin"),"."),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Application")," > ",(0,o.kt)("strong",{parentName:"li"},"Applications")," ."),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Browse App Catalog"),","),(0,o.kt)("li",{parentName:"ol"},"Search for ",(0,o.kt)("em",{parentName:"li"},"ngrok"),", and then click ",(0,o.kt)("strong",{parentName:"li"},"Add"),"."),(0,o.kt)("li",{parentName:"ol"},"Enter the ",(0,o.kt)("strong",{parentName:"li"},"Application label")," \u2014 this is the app name that will be displayed in the okta dashboard for end users \u2014 and click ",(0,o.kt)("strong",{parentName:"li"},"Next"),"."),(0,o.kt)("li",{parentName:"ol"},"Select ",(0,o.kt)("strong",{parentName:"li"},"OpenID Connect"),", and then enter the following:",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Sign-in redirect URI"),": ",(0,o.kt)("a",{parentName:"li",href:"https://idp.ngrok.com/oauth2/callback"},"https://idp.ngrok.com/oauth2/callback")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Login initiated by"),": Login initiated by app"))),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Done"),"."),(0,o.kt)("li",{parentName:"ol"},"Under the ",(0,o.kt)("strong",{parentName:"li"},"Sign On")," tab of the ngrok application, ",(0,o.kt)("strong",{parentName:"li"},"copy the Client ID and Client Secret"),". These values will be used at ngrok to complete the configuration.")),(0,o.kt)("h3",{id:"grant-access-to-okta-people-and-groups"},"Grant access to Okta people and groups"),(0,o.kt)("p",null,"Okta allows administrators to restrict access to SSO apps \u2014 such as ngrok \u2014 via assignments. By default, apps created in Okta have no assignments \u2014 in other words, nobody can use Okta SSO to access ngrok until you assign them to the app. To assign Okta users and groups to the ngrok app:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Application")," > ",(0,o.kt)("strong",{parentName:"li"},"Applications")," ."),(0,o.kt)("li",{parentName:"ol"},"Search for and click the ",(0,o.kt)("strong",{parentName:"li"},"ngrok app"),"."),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Assignments"),"."),(0,o.kt)("li",{parentName:"ol"},"Use the ",(0,o.kt)("strong",{parentName:"li"},"Assign")," button to associate groups and users with the ngrok app. ",(0,o.kt)("strong",{parentName:"li"},"To test the SSO with ngrok, make sure you're assigned to the app"),".")),(0,o.kt)("h2",{id:"configure-ngrok"},(0,o.kt)("strong",{parentName:"h2"},"Step 2"),": Configure ngrok"),(0,o.kt)("p",null,"ngrok can leverage Okta SSO in two ways:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"From the ngrok CLI (using the ",(0,o.kt)("inlineCode",{parentName:"li"},"--oidc")," parameter)"),(0,o.kt)("li",{parentName:"ul"},"From the ngrok dashboard")),(0,o.kt)("h3",{id:"option-1-ngrok-cli"},(0,o.kt)("strong",{parentName:"h3"},"Option 1"),": ngrok CLI"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Note:")," For this tutorial, we assume you have an app running locally (i.e., on localhost:3000) with the ngrok client installed.")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Launch a terminal")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the following command to launch an ngrok tunnel with Okta SSO. Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<okta_url>")," with your okta org address (i.e., ",(0,o.kt)("a",{parentName:"p",href:"https://acme.okta.com"},"https://acme.okta.com"),") and the ",(0,o.kt)("inlineCode",{parentName:"p"},"<okta_client_id>")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"<okta_client_secret>")," with the respective values copied from the ngrok app registered at Okta. Optionally, add the ",(0,o.kt)("inlineCode",{parentName:"p"},"--domain <domain>")," argument to get your own custom URL, replacing ",(0,o.kt)("inlineCode",{parentName:"p"},"<domain>")," with your URL of preference:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok http 3000 --oidc=<okta_url> \\\n--oidc-client-id=<okta_client_id> \\\n--oidc-client-secret=<okta_client_secret> \\\n--domain=<domain>\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Copy the url available next to ",(0,o.kt)("strong",{parentName:"p"},"Forwarding")," (for example, ",(0,o.kt)("inlineCode",{parentName:"p"},"https://okta-sso-test.ngrok.dev"),").")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Skip to ",(0,o.kt)("strong",{parentName:"p"},"Step 3")))),(0,o.kt)("h3",{id:"option-2-ngrok-edge"},(0,o.kt)("strong",{parentName:"h3"},"Option 2"),": ngrok Edge"),(0,o.kt)("p",null,"To configure an edge with Okta:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to dashboard.ngrok.com.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Cloud Edge")," > ",(0,o.kt)("strong",{parentName:"p"},"Edges"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"If you don't have an edge already set to add Okta SSO, create a test edge:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"New Edge")),(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"HTTPS Edge")),(0,o.kt)("li",{parentName:"ul"},"Click the ",(0,o.kt)("strong",{parentName:"li"},"pencil icon"),' next to "no description". Enter ',(0,o.kt)("em",{parentName:"li"},"Edge with Okta SSO")," as the edge name and click ",(0,o.kt)("strong",{parentName:"li"},"Save"),"."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"On the edge settings, click ",(0,o.kt)("strong",{parentName:"p"},"OIDC"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Begin setup")," and enter the following:"),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"Okta config in ngrok",src:a(70277).Z,width:"1844",height:"906"})),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Issuer URL"),": Your okta tenant url (i.e. ",(0,o.kt)("a",{parentName:"li",href:"https://acme.oktapreview.com"},"https://acme.oktapreview.com"),")."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client ID"),": The client id copied from Okta"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client Secret"),": The client secret copied from Okta"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Save"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Launch a tunnel connected to your Okta edge:"))),(0,o.kt)("admonition",{title:"Note",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"For this step, we assume you have an app running locally (i.e. on localhost:3000) with the ngrok client installed.")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Start a tunnel"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click the ",(0,o.kt)("strong",{parentName:"p"},"copy icon")," next to the tunnel command."),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"tunnel config",src:a(1305).Z,width:"1196",height:"540"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Launch a tunnel:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Launch a terminal"),(0,o.kt)("li",{parentName:"ul"},"Paste the command. Replace http://localhost:80 with your local web app addess (i.e., http://localhost:3000)"),(0,o.kt)("li",{parentName:"ul"},"hit ",(0,o.kt)("strong",{parentName:"li"},"Enter"),". an ngrok tunnel associated to your edge configuration will launch."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To confirm that the tunnel is connected to your edge:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Return to the ngrok dashboard"),(0,o.kt)("li",{parentName:"ul"},"Close the ",(0,o.kt)("strong",{parentName:"li"},"Start a tunnel")," and the ",(0,o.kt)("strong",{parentName:"li"},"Tunnel group")," tabs"),(0,o.kt)("li",{parentName:"ul"},"Refresh the test edge page. Under traffic, You will see the message ",(0,o.kt)("em",{parentName:"li"},"You have 1 tunnel online. Start additional tunnels to begin load balancing"))),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"tunnel confirmed",src:a(50953).Z,width:"1662",height:"394"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the test edge, copy the ",(0,o.kt)("strong",{parentName:"p"},"endpoint URL"),". (you will use this url to test the Okta Authentication)\n",(0,o.kt)("img",{alt:"tunnel url",src:a(63893).Z,width:"1606",height:"984"})))),(0,o.kt)("h2",{id:"test-sso"},"Step 3: Test the integration"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"In your browser, launch an incognito window."),(0,o.kt)("li",{parentName:"ol"},"Access your ngrok tunnel (i.e., ",(0,o.kt)("a",{parentName:"li",href:"https://okta-sso-test.ngrok.io"},"https://okta-sso-test.ngrok.io")," or using a copied URL)."),(0,o.kt)("li",{parentName:"ol"},"You should be prompted to log in with your Okta credentials."),(0,o.kt)("li",{parentName:"ol"},"After logging in, you should be able to see your web app.")))}c.isMDXComponent=!0},70277:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/okta-1-2a5d3a87e9180e5ecf4d7eba11d3aa72.png"},1305:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/okta-2-ed10b4a19df44cf581ec4672a69ff90f.png"},50953:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/okta-3-32c1cd6f4f851d88c953fd6a30bf1d35.png"},63893:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/okta-4-926de3d19a422657b759f31dbe8b4f33.png"}}]);