"use strict";(self.webpackChunkngrok_doc=self.webpackChunkngrok_doc||[]).push([[68634],{68920:(t,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>n,metadata:()=>s,toc:()=>l});var o=i(51163),a=(i(59496),i(49613));const n={description:"Authenticate users with Azure AD OAuth"},r="Microsoft OAuth",s={unversionedId:"integrations/microsoft/oauth",id:"integrations/microsoft/oauth",title:"Microsoft OAuth",description:"Authenticate users with Azure AD OAuth",source:"@site/docs/integrations/microsoft/oauth.mdx",sourceDirName:"integrations/microsoft",slug:"/integrations/microsoft/oauth",permalink:"/docs/integrations/microsoft/oauth",draft:!1,editUrl:"https://github.com/ngrok/ngrok-docs/edit/main/docs/integrations/microsoft/oauth.mdx",tags:[],version:"current",lastUpdatedBy:"Alan Shreve",lastUpdatedAt:1693163609,formattedLastUpdatedAt:"Aug 27, 2023",frontMatter:{description:"Authenticate users with Azure AD OAuth"},sidebar:"docs",previous:{title:"Microsoft",permalink:"/docs/integrations/microsoft/"},next:{title:"miniOrange",permalink:"/docs/integrations/miniorange/"}},c={},l=[{value:"Creating a custom Microsoft OAuth application",id:"creating-a-custom-microsoft-oauth-application",level:2},{value:"Register an application",id:"register-an-application",level:3},{value:"Configure your application",id:"configure-your-application",level:3},{value:"Update your endpoint configuration",id:"update-your-endpoint-configuration",level:3},{value:"Additional application setup information",id:"additional-application-setup-information",level:3}],p={toc:l},d="wrapper";function u(t){let{components:e,...n}=t;return(0,a.kt)(d,(0,o.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"microsoft-oauth"},"Microsoft OAuth"),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"creating-a-custom-microsoft-oauth-application"},"Creating a custom Microsoft OAuth application"),(0,a.kt)("p",null,"Step-by-step instructions below closely follow ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app"},"Microsoft documentation")," to create a new application for ngrok within the Azure portal."),(0,a.kt)("h3",{id:"register-an-application"},"Register an application"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Sign-in to the ",(0,a.kt)("a",{parentName:"li",href:"https://portal.azure.com/"},"Azure portal")," then select or ",(0,a.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-create-new-tenant"},"create a tenant")," for your application."),(0,a.kt)("li",{parentName:"ol"},'Search for "Azure Active Directory" and select it.'),(0,a.kt)("li",{parentName:"ol"},'Select "App registrations" on the left hand navigation.'),(0,a.kt)("li",{parentName:"ol"},'Select "New registration" at the top.'),(0,a.kt)("li",{parentName:"ol"},"Enter a name for your application."),(0,a.kt)("li",{parentName:"ol"},"ngrok does not support ",(0,a.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/single-and-multi-tenant-apps"},(0,a.kt)("strong",{parentName:"a"},"single tenant")," applications"),". Choose supported account types from:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Accounts in any organizational directory (Any Azure AD directory - Multitenant)"),(0,a.kt)("li",{parentName:"ul"},"Accounts in any organizational directory (Any Azure AD directory - Multitenant) and personal Microsoft accounts (e.g. Skype, Xbox)"))),(0,a.kt)("li",{parentName:"ol"},'Choose a "Web" redirect URI and enter ',(0,a.kt)("inlineCode",{parentName:"li"},"https://idp.ngrok.com/oauth2/callback"),"."),(0,a.kt)("li",{parentName:"ol"},"Register your application. The final form should resemble: ",(0,a.kt)("a",{target:"_blank",href:i(94947).Z},(0,a.kt)("img",{src:i(69319).Z,width:"847",height:"556"})))),(0,a.kt)("h3",{id:"configure-your-application"},"Configure your application"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},'When viewing your application, choose "Overview" on the left hand navigation.'),(0,a.kt)("li",{parentName:"ol"},'Store the "Application (client) ID" in the top information section for later. ',(0,a.kt)("a",{target:"_blank",href:i(93512).Z},(0,a.kt)("img",{src:i(68761).Z,width:"1057",height:"487"}))),(0,a.kt)("li",{parentName:"ol"},'Select "API permissions" on the left hand navigation.'),(0,a.kt)("li",{parentName:"ol"},"Add additional scopes that your application requires and store them for later.",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Scopes which require an application review by Microsoft are unsupported."),(0,a.kt)("li",{parentName:"ul"},"Scopes that ",(0,a.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent#admin-restricted-permissions"},"require admin consent")," prevent tenants' users from authorizing until consent is granted."))),(0,a.kt)("li",{parentName:"ol"},"Ensure ",(0,a.kt)("inlineCode",{parentName:"li"},"User.Read")," or a more permissive scope (e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"User.Read.All"),") is configured for ngrok. Example minimal configuration: ",(0,a.kt)("a",{target:"_blank",href:i(76481).Z},(0,a.kt)("img",{src:i(53319).Z,width:"788",height:"483"}))),(0,a.kt)("li",{parentName:"ol"},'Choose "Certificates and Secrets" on the left hand navigation.'),(0,a.kt)("li",{parentName:"ol"},'Select "New Client Secret" at the bottom, name the secret, set an expiration, and hit create.'),(0,a.kt)("li",{parentName:"ol"},'Creation is asynchronous. When complete, save the secret from the "Value" column (blurred below) for later: ',(0,a.kt)("a",{target:"_blank",href:i(71844).Z},(0,a.kt)("img",{src:i(98481).Z,width:"1317",height:"606"})))),(0,a.kt)("h3",{id:"update-your-endpoint-configuration"},"Update your endpoint configuration"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Return to the ngrok dashboard and create or edit an OAuth endpoint configuration module."),(0,a.kt)("li",{parentName:"ol"},"Choose to use your own application with Microsoft as the provider."),(0,a.kt)("li",{parentName:"ol"},"Include the scopes, client ID, and client secret for your application.")),(0,a.kt)("h3",{id:"additional-application-setup-information"},"Additional application setup information"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-create-new-tenant"},"Creating an Azure AD tenant")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent#admin-restricted-permissions"},"Permissions and consent")," (restricted permissions)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developers.facebook.com/docs/facebook-login/handling-declined-permissions#reprompt"},"Graph API User object properties")," (id, displayName, and mail/userPrincipalName)")))}u.isMDXComponent=!0},94947:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/files/1-microsoft-create_app-db2bc7cb109c5c15074d9bed42819e88.png"},93512:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/files/2-microsoft-app_overview-5616b74562cab4343eda701d43e11543.png"},76481:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/files/3-microsoft-api_permissions-b45f4cc55792eb5b54c0be983c567efb.png"},71844:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/files/4-microsoft-client_secret-b73ce898331ef5f0366a2d9853bc3223.png"},69319:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/images/1-microsoft-create_app-db2bc7cb109c5c15074d9bed42819e88.png"},68761:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/images/2-microsoft-app_overview-5616b74562cab4343eda701d43e11543.png"},53319:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/images/3-microsoft-api_permissions-b45f4cc55792eb5b54c0be983c567efb.png"},98481:(t,e,i)=>{i.d(e,{Z:()=>o});const o=i.p+"assets/images/4-microsoft-client_secret-b73ce898331ef5f0366a2d9853bc3223.png"}}]);