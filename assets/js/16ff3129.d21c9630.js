"use strict";(self.webpackChunkngrok_doc=self.webpackChunkngrok_doc||[]).push([[48005],{78340:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>u,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var o=e(51163),a=(e(59496),e(49613));const i={},r="Securing ngrok",s={unversionedId:"guides/securing-your-tunnels",id:"guides/securing-your-tunnels",title:"Securing ngrok",description:"---",source:"@site/docs/guides/securing-your-tunnels.md",sourceDirName:"guides",slug:"/guides/securing-your-tunnels",permalink:"/docs/guides/securing-your-tunnels",draft:!1,editUrl:"https://github.com/ngrok/ngrok-docs/edit/main/docs/guides/securing-your-tunnels.md",tags:[],version:"current",lastUpdatedBy:"Russ Savage",lastUpdatedAt:1691862991,formattedLastUpdatedAt:"Aug 12, 2023",frontMatter:{},sidebar:"docs",previous:{title:"Securing your applications with OAuth 2.0",permalink:"/docs/guides/securing-with-oauth"},next:{title:"Upgrading to ngrok Agent v3",permalink:"/docs/guides/upgrade-v2-v3"}},u={},l=[{value:"Agent Configuration",id:"agent-configuration",level:2},{value:"Installation",id:"installation",level:3},{value:"Authtokens",id:"authtokens",level:3},{value:"Encryption",id:"encryption",level:3},{value:"Using a custom ingress domain",id:"using-a-custom-ingress-domain",level:3},{value:"Tunnel Configuration",id:"tunnel-configuration",level:2},{value:"TLS termination",id:"tls-termination",level:3},{value:"Minimum TLS version",id:"minimum-tls-version",level:3},{value:"Automated TLS certificates provisioning",id:"automated-tls-certificates-provisioning",level:3},{value:"Observability",id:"observability",level:3},{value:"Blocking non-corporate accounts",id:"blocking-non-corporate-accounts",level:3},{value:"API Configuration",id:"api-configuration",level:2},{value:"Dashboard Configuration",id:"dashboard-configuration",level:2},{value:"Dashboard authentication",id:"dashboard-authentication",level:3}],c={toc:l},g="wrapper";function d(t){let{components:n,...e}=t;return(0,a.kt)(g,(0,o.Z)({},c,e,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"securing-ngrok"},"Securing ngrok"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"This guide will walk you through recommendations for ensuring you are using ngrok securely."),(0,a.kt)("h2",{id:"agent-configuration"},"Agent Configuration"),(0,a.kt)("h3",{id:"installation"},"Installation"),(0,a.kt)("p",null,"Do not run ngrok as root, as it should not be necessary."),(0,a.kt)("p",null,"Do not open any additional incoming ports in your firewall. ngrok only makes an outbound connection upon start."),(0,a.kt)("p",null,"Consider restricting the IPs that are able to start ngrok agent sessions."),(0,a.kt)("h3",{id:"authtokens"},"Authtokens"),(0,a.kt)("p",null,"Assign a ",(0,a.kt)("a",{parentName:"p",href:"/secure-tunnels/ngrok-agent/tunnel-authtokens#per-agent-authtokens"},"unique Authtoken to each ngrok agent")," deployment to isolate issues if a specific Authtoken is compromised."),(0,a.kt)("p",null,"Set up a ",(0,a.kt)("a",{parentName:"p",href:"/secure-tunnels/ngrok-agent/tunnel-authtokens#authtoken-acl-enforcement"},"minimum ACL per Authtoken")," to limit the endpoints each agent is able to start."),(0,a.kt)("h3",{id:"encryption"},"Encryption"),(0,a.kt)("p",null,"For our HTTP tunnel type, use ",(0,a.kt)("inlineCode",{parentName:"p"},"scheme https")," to configure the ngrok agent to open only a HTTPS endpoint and not a HTTP endpoint. If you are running the latest ngrok agent, this is the default."),(0,a.kt)("p",null,"If your local service is not running on the same machine as the ngrok agent, we recommend that you set up TLS encryption for the ngrok agent to upstream service leg of the tunnel using our ",(0,a.kt)("a",{parentName:"p",href:"/secure-tunnels/tunnels/http-tunnels#local-https"},"local HTTPS feature"),"."),(0,a.kt)("p",null,"For custom domains, use ngrok's ",(0,a.kt)("a",{parentName:"p",href:"/cloud-edge/endpoints#automated-tls-certificates"},"Automated TLS certificates")," to have ngrok automatically provision a TLS certificate for your endpoint from Let's Encrypt."),(0,a.kt)("h3",{id:"using-a-custom-ingress-domain"},"Using a custom ingress domain"),(0,a.kt)("p",null,"If your organization uses a custom ingress domain, your default ngrok configuration will not work. Edit your ngrok agent confirmation to add a ",(0,a.kt)("a",{parentName:"p",href:"/secure-tunnels/ngrok-agent/reference/config#server_addr"},(0,a.kt)("inlineCode",{parentName:"a"},"server_addr"))," parameter to use the custom ingress domain of your organization."),(0,a.kt)("h2",{id:"tunnel-configuration"},"Tunnel Configuration"),(0,a.kt)("h3",{id:"tls-termination"},"TLS termination"),(0,a.kt)("p",null,"TLS Encryption is terminated at different locations depending on the ngrok Tunnel / Edge type and configuration. See the documentation on ",(0,a.kt)("a",{parentName:"p",href:"/cloud-edge#terminating-tls-connections"},"Terminating TLS Connections")," for more details."),(0,a.kt)("h3",{id:"minimum-tls-version"},"Minimum TLS version"),(0,a.kt)("p",null,"It is possible to specify the minimum TLS version that clients are required to use to talk to the ngrok edge for your tunnel."),(0,a.kt)("h3",{id:"automated-tls-certificates-provisioning"},"Automated TLS certificates provisioning"),(0,a.kt)("p",null,"For HTTPS endpoints, ngrok will take care of TLS certificates automatically. For endpoints that are ngrok subdomains, ngrok uses a wildcard certificate. We also provision certificates for your custom domains through Let's Encrypt and handle keeping them up to date for you."),(0,a.kt)("h3",{id:"observability"},"Observability"),(0,a.kt)("p",null,"ngrok provides functionality for consuming logs for events in the system. For more information, check out our ",(0,a.kt)("a",{parentName:"p",href:"/cloud-edge/observability"},"ngrok Event Subscriptions documentation"),"."),(0,a.kt)("h3",{id:"blocking-non-corporate-accounts"},"Blocking non-corporate accounts"),(0,a.kt)("p",null,"For a tighter security policy, most administrators will want to block ngrok accounts that are not a part of their organization. The fastest approach is to block DNS lookups to the URLs used by the agent to connect to the ngrok cloud. These are the DNS lookups to block:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"connect.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.us.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.eu.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.ap.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.au.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.sa.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.jp.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"connect.in.ngrok-agent.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.us.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.eu.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.ap.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.au.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.sa.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.jp.ngrok.com"),(0,a.kt)("li",{parentName:"ul"},"tunnel.in.ngrok.com")),(0,a.kt)("h2",{id:"api-configuration"},"API Configuration"),(0,a.kt)("p",null,"You need a API key to authenticate with the ngrok REST API. API keys are Base64 encoded strings and are available from the ngrok dashboard and also from an API endpoint, which makes it easy to rotate your API keys."),(0,a.kt)("p",null,"Consider restricting the IPs permitted to access the API. You can do so in the ngrok Dashboard under the Security section."),(0,a.kt)("h2",{id:"dashboard-configuration"},"Dashboard Configuration"),(0,a.kt)("h3",{id:"dashboard-authentication"},"Dashboard authentication"),(0,a.kt)("p",null,"For authenticating access to the dashboard, ngrok has features for role based access control (RBAC), IP Policy, and ",(0,a.kt)("a",{parentName:"p",href:"/user-management#dashboard-sso"},"Single Sign-On"),"."),(0,a.kt)("p",null,"With RBAC, you can configure permissions for groups of users within your team (for example admins and developers)."),(0,a.kt)("p",null,"Consider restricting the IPs permitted to access the dashboard."))}d.isMDXComponent=!0}}]);