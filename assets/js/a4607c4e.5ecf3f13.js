"use strict";(self.webpackChunkngrok_doc=self.webpackChunkngrok_doc||[]).push([[12229],{9823:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>u});var o=n(51163),r=(n(59496),n(49613));const a={sidebar_position:2},i="TLS Tunnels",s={unversionedId:"secure-tunnels/tunnels/tls-tunnels",id:"secure-tunnels/tunnels/tls-tunnels",title:"TLS Tunnels",description:"---",source:"@site/docs/secure-tunnels/tunnels/tls-tunnels.md",sourceDirName:"secure-tunnels/tunnels",slug:"/secure-tunnels/tunnels/tls-tunnels",permalink:"/docs/secure-tunnels/tunnels/tls-tunnels",draft:!1,editUrl:"https://github.com/ngrok/ngrok-docs/edit/main/docs/secure-tunnels/tunnels/tls-tunnels.md",tags:[],version:"current",lastUpdatedBy:"Russ Savage",lastUpdatedAt:1691862991,formattedLastUpdatedAt:"Aug 12, 2023",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docs",previous:{title:"HTTP Tunnels",permalink:"/docs/secure-tunnels/tunnels/http-tunnels"},next:{title:"TCP Tunnels",permalink:"/docs/secure-tunnels/tunnels/tcp-tunnels"}},l={},u=[{value:"Forward TLS traffic to a local HTTPS server on port 443",id:"forward-tls-traffic-to-a-local-https-server-on-port-443",level:6},{value:"TLS Tunnels without certificate warnings",id:"tls-cert-warnings",level:2},{value:"Forward TLS traffic over your own custom domain",id:"forward-tls-traffic-over-your-own-custom-domain",level:6},{value:"Terminating TLS connections",id:"tls-termination",level:2},{value:"Offload TLS Termination to the ngrok Agent",id:"offload-tls-termination-to-the-ngrok-agent",level:6},{value:"Running non-HTTP services over TLS tunnels",id:"tls-agnostic",level:2},{value:"Compatible Clients",id:"tls-compatibility",level:2},{value:"TLS Tunnel Examples",id:"examples",level:2},{value:"TLS Tunnel Configuration Options",id:"configuration-options",level:2}],c={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"tls-tunnels"},"TLS Tunnels"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"HTTPS tunnels terminate all TLS (SSL) traffic at the ngrok.com servers using ngrok.com certificates. For production-grade services, you'll want your tunneled traffic to be encrypted with your own TLS key and certificate. ngrok makes this extraordinarily easy with TLS tunnels."),(0,r.kt)("p",null,"Check out the ",(0,r.kt)("a",{parentName:"p",href:"/secure-tunnels/ngrok-agent/reference/ngrok#ngrok-tls"},"ngrok agent TLS tunnel documentation")," for the complete details for starting a TLS Tunnel."),(0,r.kt)("h6",{id:"forward-tls-traffic-to-a-local-https-server-on-port-443"},"Forward TLS traffic to a local HTTPS server on port 443"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ngrok tls --domain=encrypted.ngrok.dev 443\n")),(0,r.kt)("p",null,"Once your tunnel is running, try accessing it with curl."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"curl --insecure https://encrypted.ngrok.dev\n")),(0,r.kt)("h2",{id:"tls-cert-warnings"},"TLS Tunnels without certificate warnings"),(0,r.kt)("p",null,"Notice that ",(0,r.kt)("inlineCode",{parentName:"p"},"--insecure")," option in the previous ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command example? You need to specify that because your local HTTPS server doesn't have the TLS key and certificate necessary to terminate traffic for any subdomains of ngrok owned domains. If you try to load up that page in a web browser, you'll notice that it tells you the page could be insecure because the certificate does not match."),(0,r.kt)("p",null,"If you want your certificates to match and be protected from man-in-the-middle attacks, you need two things. First, you'll need to buy an SSL (TLS) certificate for a domain name that you own and configure your local web server to use that certificate and its private key to terminate TLS connections. How to do this is specific to your web server and SSL certificate provider and beyond the scope of this documentation. For the sake of example, we'll assume that you were issued an SSL certificate for the domain ",(0,r.kt)("inlineCode",{parentName:"p"},"secure.example.com"),"."),(0,r.kt)("p",null,"Once you have your key and certificate and have installed them properly, it's now time to run a TLS tunnel on your own custom domain name. The instructions to set this up are identical to those described in the HTTP tunnels section: ",(0,r.kt)("a",{parentName:"p",href:"/docs/secure-tunnels/tunnels/http-tunnels#custom-subdomains"},"Tunnels on custom domains"),". The custom domain you register should be the same as the one in your SSL certificate (use the ",(0,r.kt)("inlineCode",{parentName:"p"},"--domain")," argument to start the TLS tunnel on your own domain)."),(0,r.kt)("h6",{id:"forward-tls-traffic-over-your-own-custom-domain"},"Forward TLS traffic over your own custom domain"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ngrok tls --domain=secure.example.com 443\n")),(0,r.kt)("h2",{id:"tls-termination"},"Terminating TLS connections"),(0,r.kt)("p",null,"It's possible that the service you're trying to expose may not have the capability to terminate TLS connections. The ngrok agent can do this for you so that you can encrypt your traffic end-to-end but not have to worry about whether the local service has TLS support. Specify both the ",(0,r.kt)("inlineCode",{parentName:"p"},"-crt")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"-key")," command line options to specify the filesystem paths to your TLS certificate and key and the ngrok agent will take care of terminating TLS connections for you."),(0,r.kt)("h6",{id:"offload-tls-termination-to-the-ngrok-agent"},"Offload TLS Termination to the ngrok Agent"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ngrok tls --domain secure.example.com --key /path/to/tls.key --crt /path/to/tls.crt 80\n")),(0,r.kt)("h2",{id:"tls-agnostic"},"Running non-HTTP services over TLS tunnels"),(0,r.kt)("p",null,"ngrok TLS tunnels make ",(0,r.kt)("strong",{parentName:"p"},"no assumptions about the underlying protocol")," being transported. All examples in this documentation use HTTPS because it is the most common use case, but you can run run any TLS-wrapped protocol over a TLS tunnel (e.g. IMAPS, SMTPS, SIPS, SRTP, etc) without any changes."),(0,r.kt)("h2",{id:"tls-compatibility"},"Compatible Clients"),(0,r.kt)("p",null,"TLS tunnels work by inspecting the data present in the Server Name Information (SNI) extension on incoming TLS connections. Not all clients that initiate TLS connections support setting the SNI extension data. These clients will not work properly with ngrok's TLS tunnels. Fortunately, nearly all modern browsers use SNI. Some modern software libraries do not though. The following list of clients do not support SNI and will not work with TLS tunnels:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Microsoft Internet Explorer 6.0"),(0,r.kt)("li",{parentName:"ul"},"Microsoft Internet Explorer 7 & 8 on Windows XP or earlier"),(0,r.kt)("li",{parentName:"ul"},"Native browser on Android 2.X"),(0,r.kt)("li",{parentName:"ul"},"Java <=1.6"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stackoverflow.com/questions/18578439/using-requests-with-tls-doesnt-give-sni-support/18579484#18579484"},"Python 2.X, 3.0, 3.1 if required modules are not installed"))),(0,r.kt)("p",null,"A more complete list can be found on ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Server_Name_Indication#No_support"},"the Server Name Indication page on Wikipedia")),(0,r.kt)("h2",{id:"examples"},"TLS Tunnel Examples"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"# forward TLS traffic for www.example.com to port 443 (requires CNAME)\nngrok tls --domain=www.example.com 443\n\n# forward TLS traffic on subdomain (mismatch certificate warning)\nngrok tls 1234\n\n# terminate TLS traffic for t.co before forwarding\nngrok tls --domain=t.co --crt=/path/to/t.co.crt --key=/path/to/t.co.key 443\n")),(0,r.kt)("h2",{id:"configuration-options"},"TLS Tunnel Configuration Options"),(0,r.kt)("p",null,"Check out the ",(0,r.kt)("a",{parentName:"p",href:"/secure-tunnels/ngrok-agent/reference/ngrok#ngrok-tls"},"ngrok agent TLS tunnel documentation")," for all the configuration options for TLS tunnels."))}p.isMDXComponent=!0}}]);