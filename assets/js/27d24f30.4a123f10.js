"use strict";(self.webpackChunkngrok_doc=self.webpackChunkngrok_doc||[]).push([[27572],{35430:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>s,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var a=n(51163),o=(n(59496),n(49613));const i={description:"Use FusionAuth SSO to secure access to ngrok tunnels"},r="FusionAuth SSO (OpenID Connect)",l={unversionedId:"integrations/fusionauth/sso-oidc",id:"integrations/fusionauth/sso-oidc",title:"FusionAuth SSO (OpenID Connect)",description:"Use FusionAuth SSO to secure access to ngrok tunnels",source:"@site/docs/integrations/fusionauth/sso-oidc.md",sourceDirName:"integrations/fusionauth",slug:"/integrations/fusionauth/sso-oidc",permalink:"/docs/integrations/fusionauth/sso-oidc",draft:!1,editUrl:"https://github.com/ngrok/ngrok-docs/edit/main/docs/integrations/fusionauth/sso-oidc.md",tags:[],version:"current",lastUpdatedBy:"Russ Savage",lastUpdatedAt:1693002758,formattedLastUpdatedAt:"Aug 25, 2023",frontMatter:{description:"Use FusionAuth SSO to secure access to ngrok tunnels"},sidebar:"docs",previous:{title:"FusionAuth",permalink:"/docs/integrations/fusionauth/"},next:{title:"GitHub",permalink:"/docs/integrations/github/"}},s={},u=[{value:"Supported Features",id:"supported-features",level:2},{value:"Requirements",id:"requirements",level:2},{value:"Configuration Steps",id:"configuration-steps",level:2},{value:"<strong>Step 1</strong>: Configure FusionAuth",id:"configure-FusionAuth",level:2},{value:"Add the ngrok App in FusionAuth",id:"add-the-ngrok-app-in-fusionauth",level:3},{value:"<strong>Step 2</strong>: Configure ngrok",id:"configure-ngrok",level:2},{value:"<strong>Option 1</strong>: ngrok CLI",id:"option-1-ngrok-cli",level:3},{value:"<strong>Option 2</strong>: ngrok Edge",id:"option-2-ngrok-edge",level:3},{value:"Step 3: Test the integration",id:"test-sso",level:2}],p={toc:u},k="wrapper";function h(t){let{components:e,...i}=t;return(0,o.kt)(k,(0,a.Z)({},p,i,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"fusionauth-sso-openid-connect"},"FusionAuth SSO (OpenID Connect)"),(0,o.kt)("hr",null),(0,o.kt)("admonition",{title:"TL;DR",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"To secure access to ngrok with FusionAuth Single Sign-On using OpenID Connect:"),(0,o.kt)("ol",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"#configure-FusionAuth"},"Configure FusionAuth SSO")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"#configure-ngrok"},"Configure ngrok")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"#test-sso"},"Test access to ngrok with FusionAuth SSO")))),(0,o.kt)("p",null,"This article details how to configure FusionAuth as the primary Identity Provider for ngrok tunnels.\nBy integrating FusionAuth SSO with ngrok, you can:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Restrict access to ngrok tunnels")," only to users authenticated via FusionAuth"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Use FusionAuth Premium Features and Login Methods")," \u2014 including Advanced Registration Forms, Passwordless Login, WebAuthn, ",(0,o.kt)("strong",{parentName:"li"},"and Advanced Threat Detection to control access to ngrok tunnels"),".")),(0,o.kt)("h2",{id:"supported-features"},"Supported Features"),(0,o.kt)("p",null,"The ngrok integration with FusionAuth supports:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"OIDC based SSO"),": In this mode, users access ngrok edges and tunnels and are redirected to FusionAuth for authentication.")),(0,o.kt)("h2",{id:"requirements"},"Requirements"),(0,o.kt)("p",null,"To configure ngrok tunnels with FusionAuth, you must have:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A public facing FusionAuth instance. You can spin up a basic ",(0,o.kt)("a",{parentName:"li",href:"https://fusionauth.io/pricing"},"FusionAuth Cloud instance")," or ",(0,o.kt)("a",{parentName:"li",href:"https://fusionauth.io/docs/v1/tech/installation-guide/"},"install it on any server"),"."),(0,o.kt)("li",{parentName:"ul"},"An ",(0,o.kt)("a",{parentName:"li",href:"https://ngrok.com/pricing"},"ngrok Enterprise Account")," with an authtoken or admin access to configure edges with OpenID Connect."),(0,o.kt)("li",{parentName:"ul"},"A local web app or application that needs to be protected by Fusion Auth.")),(0,o.kt)("h2",{id:"configuration-steps"},"Configuration Steps"),(0,o.kt)("p",null,"To integrate ngrok with FusionAuth SSO, you will need to:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Configure FusionAuth with the ngrok app"),(0,o.kt)("li",{parentName:"ol"},"Configure ngrok with the SSO settings provided by FusionAuth")),(0,o.kt)("h2",{id:"configure-FusionAuth"},(0,o.kt)("strong",{parentName:"h2"},"Step 1"),": Configure FusionAuth"),(0,o.kt)("h3",{id:"add-the-ngrok-app-in-fusionauth"},"Add the ngrok App in FusionAuth"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Navigate to your FusionAuth instance."),(0,o.kt)("li",{parentName:"ol"},"Navigate to ",(0,o.kt)("strong",{parentName:"li"},"Tenants")," > ",(0,o.kt)("strong",{parentName:"li"},"Your Tenant")," and change the issuer to the URL of your FusionAuth instance. For example, ",(0,o.kt)("a",{parentName:"li",href:"https://acme.fusionauth.io"},"https://acme.fusionauth.io"),"."),(0,o.kt)("li",{parentName:"ol"},"Navigate to ",(0,o.kt)("strong",{parentName:"li"},"Applications")," and then create a new Application. Fill out the ",(0,o.kt)("strong",{parentName:"li"},"Name")," field, then click the ",(0,o.kt)("strong",{parentName:"li"},"OAuth")," tab."),(0,o.kt)("li",{parentName:"ol"},"Make sure that the ",(0,o.kt)("strong",{parentName:"li"},"Enabled grants")," checkboxes have the ",(0,o.kt)("strong",{parentName:"li"},"Authorization Code")," and ",(0,o.kt)("strong",{parentName:"li"},"Refresh Token")," grants enabled."),(0,o.kt)("li",{parentName:"ol"},"In the ",(0,o.kt)("strong",{parentName:"li"},"Authorized redirect URLs")," field add ",(0,o.kt)("inlineCode",{parentName:"li"},"https://idp.ngrok.com/oauth2/callback")),(0,o.kt)("li",{parentName:"ol"},"Click the ",(0,o.kt)("inlineCode",{parentName:"li"},"Save")," button."),(0,o.kt)("li",{parentName:"ol"},"You should see values in the ",(0,o.kt)("strong",{parentName:"li"},"Client Id")," and ",(0,o.kt)("strong",{parentName:"li"},"Client secret")," fields. Copy them; ou\u2019ll use them in the ",(0,o.kt)("a",{parentName:"li",href:"#configure-ngrok"},"Configure ngrok")," step."),(0,o.kt)("li",{parentName:"ol"},"Your Application should look like this:\n",(0,o.kt)("img",{alt:"Application Configuration",src:n(27591).Z,width:"1600",height:"1628"}))),(0,o.kt)("h2",{id:"configure-ngrok"},(0,o.kt)("strong",{parentName:"h2"},"Step 2"),": Configure ngrok"),(0,o.kt)("p",null,"ngrok can leverage FusionAuth SSO in two ways:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"From the ngrok CLI (using the ",(0,o.kt)("inlineCode",{parentName:"li"},"--oidc")," parameter)"),(0,o.kt)("li",{parentName:"ul"},"From the ngrok dashboard")),(0,o.kt)("h3",{id:"option-1-ngrok-cli"},(0,o.kt)("strong",{parentName:"h3"},"Option 1"),": ngrok CLI"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Note:")," For this tutorial, we assume you have an app running locally (i.e., on localhost:3000) with the ngrok client installed.")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Launch a terminal")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the following command to launch an ngrok tunnel with FusionAuth SSO. Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<FusionAuth_url>")," with your FusionAuth org address (i.e., ",(0,o.kt)("a",{parentName:"p",href:"https://acme.FusionAuth.com"},"https://acme.FusionAuth.com"),") and the ",(0,o.kt)("inlineCode",{parentName:"p"},"<FusionAuth_client_id>")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"<FusionAuth_client_secret>")," with the respective values copied from the ngrok app registered at FusionAuth:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok http 3000 --oidc=<FusionAuth_url> \\\n--oidc-client-id=<FusionAuth_client_id> \\\n--oidc-client-secret=<FusionAuth_client_secret> \\\n--domain=fusionauth-sso-test.ngrok.dev\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Skip to ",(0,o.kt)("strong",{parentName:"p"},"Step 3")))),(0,o.kt)("h3",{id:"option-2-ngrok-edge"},(0,o.kt)("strong",{parentName:"h3"},"Option 2"),": ngrok Edge"),(0,o.kt)("p",null,"To configure an edge with FusionAuth:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Go to dashboard.ngrok.com.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Cloud Edge")," > ",(0,o.kt)("strong",{parentName:"p"},"Edges"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"If you don't have an edge already set to add FusionAuth SSO, create a test edge:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"New Edge")),(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"HTTPS Edge")),(0,o.kt)("li",{parentName:"ul"},"Click the ",(0,o.kt)("strong",{parentName:"li"},"pencil icon"),' next to "no description". Enter ',(0,o.kt)("em",{parentName:"li"},"Edge with FusionAuth SSO")," as the edge name and click ",(0,o.kt)("strong",{parentName:"li"},"Save"),"."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"On the edge settings, click ",(0,o.kt)("strong",{parentName:"p"},"OIDC"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Begin setup")," and enter the following:"),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"FusionAuth config in ngrok",src:n(12955).Z,width:"2444",height:"1622"})),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Issuer URL"),": Your FusionAuth tenant url (i.e. ",(0,o.kt)("a",{parentName:"li",href:"https://acme.fusionauth.com"},"https://acme.fusionauth.com"),")."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client ID"),": The client id copied from FusionAuth"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Client Secret"),": The client secret copied from FusionAuth"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Save"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Launch a tunnel connected to your FusionAuth edge:"))),(0,o.kt)("admonition",{title:"Note",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"For this step, we assume you have an app running locally (i.e. on localhost:3000) with the ngrok client installed.")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Start a tunnel"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click the ",(0,o.kt)("strong",{parentName:"p"},"copy icon")," next to the tunnel command."),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"tunnel config",src:n(52918).Z,width:"1196",height:"540"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Launch a tunnel:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Launch a terminal"),(0,o.kt)("li",{parentName:"ul"},"Paste the command. Replace http://localhost:80 with your local web app addess (i.e., http://localhost:3000)"),(0,o.kt)("li",{parentName:"ul"},"hit ",(0,o.kt)("strong",{parentName:"li"},"Enter"),". an ngrok tunnel associated to your edge configuration is launched."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To confirm that the tunnel is connected to your edge:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Return to the ngrok dashboard"),(0,o.kt)("li",{parentName:"ul"},"Close the ",(0,o.kt)("strong",{parentName:"li"},"Start a tunnel")," and the ",(0,o.kt)("strong",{parentName:"li"},"Tunnel group")," tabs"),(0,o.kt)("li",{parentName:"ul"},"Refresh the test edge page. Under traffic, You will see the message ",(0,o.kt)("em",{parentName:"li"},"You have 1 tunnel online. Start additional tunnels to begin load balancing"))),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{alt:"tunnel confirmed",src:n(75496).Z,width:"1662",height:"394"}))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Endpoints")," section, copy the ",(0,o.kt)("strong",{parentName:"p"},"endpoint URL"),". (you will use this url to test the FusionAuth Authentication)\n",(0,o.kt)("img",{alt:"tunnel url",src:n(21419).Z,width:"1036",height:"136"})))),(0,o.kt)("h2",{id:"test-sso"},"Step 3: Test the integration"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"In your browser, launch an incognito window."),(0,o.kt)("li",{parentName:"ol"},"Access your ngrok tunnel (i.e., ",(0,o.kt)("a",{parentName:"li",href:"https://fusionauth-sso-test.ngrok.io"},"https://fusionauth-sso-test.ngrok.io")," or using a copied URL)."),(0,o.kt)("li",{parentName:"ol"},"You should be prompted to log in with your FusionAuth credentials."),(0,o.kt)("li",{parentName:"ol"},"After login, you should be able to see your web app.")))}h.isMDXComponent=!0},27591:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/application-configuration-1ce86e0535adb9013407586919128168.png"},52918:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/fa-2-ed10b4a19df44cf581ec4672a69ff90f.png"},75496:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/fa-3-32c1cd6f4f851d88c953fd6a30bf1d35.png"},12955:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ngrok-edge-b74658ab5c66a7a1343407f80163d8b8.png"},21419:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ngrok-url-9533dfb968a080d84f685956f437e898.png"}}]);