"use strict";(self.webpackChunkngrok_doc=self.webpackChunkngrok_doc||[]).push([[19007],{25501:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var n=a(51163),o=(a(59496),a(49613));const r={title:"Raspberry Pi OS (formerly Raspbian)",description:"Learn how to install ngrok on a Raspberry Pi OS (formerly Raspbian) to provide secure remote access and management.",tags:["guides","agent","Raspberry Pi","Raspbian","iot"]},s=void 0,i={unversionedId:"guides/device-gateway/raspbian",id:"guides/device-gateway/raspbian",title:"Raspberry Pi OS (formerly Raspbian)",description:"Learn how to install ngrok on a Raspberry Pi OS (formerly Raspbian) to provide secure remote access and management.",source:"@site/docs/guides/device-gateway/raspbian.md",sourceDirName:"guides/device-gateway",slug:"/guides/device-gateway/raspbian",permalink:"/docs/guides/device-gateway/raspbian",draft:!1,editUrl:"https://github.com/ngrok/ngrok-docs/edit/main/docs/guides/device-gateway/raspbian.md",tags:[{label:"guides",permalink:"/docs/tags/guides"},{label:"agent",permalink:"/docs/tags/agent"},{label:"Raspberry Pi",permalink:"/docs/tags/raspberry-pi"},{label:"Raspbian",permalink:"/docs/tags/raspbian"},{label:"iot",permalink:"/docs/tags/iot"}],version:"current",lastUpdatedBy:"Russ Savage",lastUpdatedAt:1691862991,formattedLastUpdatedAt:"Aug 12, 2023",frontMatter:{title:"Raspberry Pi OS (formerly Raspbian)",description:"Learn how to install ngrok on a Raspberry Pi OS (formerly Raspbian) to provide secure remote access and management.",tags:["guides","agent","Raspberry Pi","Raspbian","iot"]},sidebar:"docs",previous:{title:"Raspberry Pi",permalink:"/docs/guides/device-gateway/raspberry-pi"},next:{title:"Windows",permalink:"/docs/guides/device-gateway/windows"}},l={},p=[{value:"Step 1: Install the ngrok Agent",id:"step-1-install-the-ngrok-agent",level:2},{value:"Step 2: Enable SSH access",id:"step-2-enable-ssh-access",level:2},{value:"Step 3: Adding IP restrictions",id:"step-3-adding-ip-restrictions",level:2},{value:"Step 4: Configure ngrok to recover on outages",id:"step-4-configure-ngrok-to-recover-on-outages",level:2},{value:"What&#39;s next?",id:"whats-next",level:2},{value:"Logging Traffic Events from ngrok",id:"logging-traffic-events-from-ngrok",level:3},{value:"Remote checks, stop, start, and updates",id:"remote-checks-stop-start-and-updates",level:3}],d={toc:p},g="wrapper";function c(e){let{components:t,...a}=e;return(0,o.kt)(g,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"ngrok allows you to create secure ingress to any app, device, or service without spending hours learning arcane networking technologies. You can get started with a single command or a single line of code."),(0,o.kt)("p",null,"What is ngrok? ngrok is an ingress-as-a-service platform that removes the hassle of getting code online from developers\u2019 plates by decoupling ingress from infrastructure with one line of code, all without provisioning proxies or VPNs."),(0,o.kt)("p",null,"In this guide, we'll walk you through the process of installing the ngrok agent on a remote Raspberry Pi OS (formerly Raspbian) device, ensuring the agent runs integrated into your operating system, restricting traffic to trusted origins, and integrating traffic events with your preferred logging tool."),(0,o.kt)("h2",{id:"step-1-install-the-ngrok-agent"},"Step 1: Install the ngrok Agent"),(0,o.kt)("p",null,"To download and install the ngrok agent on your remote LinuxRaspberry Pi OS device, follow these steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Open a terminal into your remote Raspberry Pi OS device.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Download the latest ngrok binary for your Linux distribution. You can find the correct binary on our ",(0,o.kt)("a",{parentName:"p",href:"https://ngrok.com/download"},"ngrok download page"),": Select your operating system, select the version, and copy the link that appears in the ",(0,o.kt)("strong",{parentName:"p"},"Download")," button.:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-linux-arm.tgz\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Unzip the downloaded file and move it to a directory in your PATH. Below is an example for ",(0,o.kt)("inlineCode",{parentName:"li"},"/usr/local/bin"),":")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo tar xvzf ./ngrok-v3-stable-linux-arm64.tgz -C /usr/local/bin\n")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Now that you have installed ngrok on your LinuxRaspberry Pi OS device, link it to your ngrok account by using your authtoken:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok authtoken NGROK_AUTHTOKEN\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"NGROK_AUTHTOKEN")," with your unique ngrok authtoken found in the ",(0,o.kt)("a",{parentName:"p",href:"https://dashboard.ngrok.com/get-started/your-authtoken"},"ngrok dashboard"),"."),(0,o.kt)("h2",{id:"step-2-enable-ssh-access"},"Step 2: Enable SSH access"),(0,o.kt)("p",null,"To enable remote SSH access to your device via ngrok:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Test that the ngrok agent is configured correctly by starting a TCP tunnel on your remove device.\n",(0,o.kt)("strong",{parentName:"li"},"Note"),": If you get an error, ensure your authtoken is configured correctly.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok tcp 22\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"The ngrok agent assigns you a TCP address and port. Use these values to test the SSH access via ngrok by running the following command from another server or from a desktop.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh -p NGROK_PORT USER@NGROK_TCP_ADDRESS\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": Replace the variables in the command line with the following:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"NGROK_PORT: The port number of the ngrok agent (i.e. if the agent shows ",(0,o.kt)("inlineCode",{parentName:"li"},"tcp://1.tcp.ngrok.io:12345"),", your port number is ",(0,o.kt)("inlineCode",{parentName:"li"},"12345"),"."),(0,o.kt)("li",{parentName:"ul"},"USER: A valid ssh login to access your remote device's operating system."),(0,o.kt)("li",{parentName:"ul"},"NGROK_TCP_ADDRESS: The address of the ngrok agent (i.e. if the agent shows ",(0,o.kt)("inlineCode",{parentName:"li"},"tcp://1.tcp.ngrok.io:12345"),", your TCP address is ",(0,o.kt)("inlineCode",{parentName:"li"},"1.tcp.ngrok.io"),".")),(0,o.kt)("h2",{id:"step-3-adding-ip-restrictions"},"Step 3: Adding IP restrictions"),(0,o.kt)("p",null,"Once you confirmed that you have connectivity to the device, add some security so that you are the only one who can access it."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": This capability requires ngrok's ",(0,o.kt)("strong",{parentName:"p"},"IP Restrictions")," feature, which is only available with a paid subscription."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"On the remote LinuxRaspberry Pi OS device terminal, stop the ngrok process using the ",(0,o.kt)("inlineCode",{parentName:"p"},"ctrl+c")," command.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Add an allow rule to restrict access to your LinuxRaspberry Pi OS device to an IP address or a range of IP addresses."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok tcp 22 --cidr-allow ALLOWED_IP_ADDRESS_CIDR\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"ALLOWED_IP_ADDRESS_CIDR")," with the CIDR notation for the allowed IP Address(es) (i.e. ",(0,o.kt)("inlineCode",{parentName:"p"},"123.123.123.0/24"),")."),(0,o.kt)("admonition",{title:"Setting IP restrictions for the entire fleet",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Alternatively, you can create an IP policy in the ngrok dashboard (under ",(0,o.kt)("a",{parentName:"p",href:"https://dashboard.ngrok.com/security/ip-restrictions"},"Security > IP Restrictions"),"), and leverage the same policy to control access to your entire device fleet.")),(0,o.kt)("h2",{id:"step-4-configure-ngrok-to-recover-on-outages"},"Step 4: Configure ngrok to recover on outages"),(0,o.kt)("p",null,"The ngrok agent works with native OS services like ",(0,o.kt)("inlineCode",{parentName:"p"},"systemd"),". This helps you ensure that the ngrok service is available even after the machine restarts. Before we do this though, it's useful to reserve a TCP address in the ngrok dashboard which allows you to reuse the same address each time the device is restarted."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Navigate to the ngrok Dashboard and access ",(0,o.kt)("a",{parentName:"li",href:"https://dashboard.ngrok.com/cloud-edge/tcp-addresses"},"Cloud Edge > TCP Addresses"),". Create a new TCP address with a description and click ",(0,o.kt)("strong",{parentName:"li"},"Save"),". Your new TCP address will look something like ",(0,o.kt)("inlineCode",{parentName:"li"},"1.tcp.ngrok.io:12345"),".")),(0,o.kt)("p",null,"Update the ngrok config file in your LinuxRaspberry Pi OS device to start the ngrok agent using this TCP address."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Open the ngrok config file:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok config edit\n")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Add the following to the end of the file and then save it:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"tunnels:\n  device-ssh:\n    proto: tcp\n    addr: 22\n    remote_addr: NGROK_TCP_ADDRESS\n    ip_restriction:\n      allow_cidrs:\n        - ALLOWED_IP_ADDRESS_CIDR\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": Make sure to replace ",(0,o.kt)("strong",{parentName:"p"},"NGROK_TCP_ADDRESS")," with the address you reserved earlier in the ngrok dashboard (i.e. ",(0,o.kt)("inlineCode",{parentName:"p"},"1.tcp.ngrok.io:12345"),") and ",(0,o.kt)("strong",{parentName:"p"},"ALLOWED_IP_ADDRESS_CIDR")," with the CIDR notation of the allowed IP Address(es) (i.e. ",(0,o.kt)("inlineCode",{parentName:"p"},"123.123.123.0/24"),")."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": Make note of the location of the ",(0,o.kt)("inlineCode",{parentName:"p"},"ngrok.yml")," file."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Enable ngrok in service mode:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok service install --config $HOME/.config/ngrok/ngrok.yml\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": You may need to run this command using ",(0,o.kt)("inlineCode",{parentName:"p"},"sudo")," depending on your system"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Run the following command to ensure your operating system launches ngrok with the ssh ingress whenever your device starts:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ngrok service start\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": You may need to run this command using ",(0,o.kt)("inlineCode",{parentName:"p"},"sudo")," depending on your system"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"With ngrok running on your device, you should be able to SSH into the device using the reserved address from the dashboard.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh -p NGROK_PORT user@NGROK_TCP_ADDRESS\n")),(0,o.kt)("h2",{id:"whats-next"},"What's next?"),(0,o.kt)("p",null,"Now that your device is integrated to ngrok, you can \u200b\u200bexecute tasks at the ngrok dashboard to operationalize your fleet:"),(0,o.kt)("h3",{id:"logging-traffic-events-from-ngrok"},"Logging Traffic Events from ngrok"),(0,o.kt)("p",null,"Each action that happens in ngrok is published as an event, and ",(0,o.kt)("a",{parentName:"p",href:"/docs/events/"},"Event Subscriptions")," allow you to subscribe to the events that are interested in and write them to one or more destinations."),(0,o.kt)("p",null,"An Event Subscription is made up of a set of event sources (some of which can be filtered), and event destinations. Each subscription can send the events to one or more destinations, such as Amazon CloudWatch Logs, Amazon Kinesis (as a data stream), or Amazon Kinesis Firehose (as a delivery stream)."),(0,o.kt)("p",null,"Event subscriptions can be configured through the ",(0,o.kt)("a",{parentName:"p",href:"https://dashboard.ngrok.com/events/subscriptions"},"ngrok Dashboard")," or the ",(0,o.kt)("a",{parentName:"p",href:"/docs/api/resources/event-destinations/"},"ngrok API"),"."),(0,o.kt)("p",null,"You can also forward all or some of your traffic events from ",(0,o.kt)("a",{parentName:"p",href:"/docs/events/"},"ngrok to your preferred logging tool"),"."),(0,o.kt)("h3",{id:"remote-checks-stop-start-and-updates"},"Remote checks, stop, start, and updates"),(0,o.kt)("p",null,"ngrok provides ",(0,o.kt)("a",{parentName:"p",href:"/docs/api/resources/tunnel-sessions/#restart-tunnel-agent"},"APIs")," and a ",(0,o.kt)("a",{parentName:"p",href:"https://dashboard.ngrok.com/tunnels/agents"},"dashboard UI")," for you to monitor the health of ngrok agents running in your fleet. The interfaces also allow you to remotely stop, start, and update agents."))}c.isMDXComponent=!0}}]);